import { addChatbotReminder } from '../../../Action/HumanAgentZendesk'
import LogEvent from '../../../Action/LogEvent'
import { FallbackIntent, PushIntent } from '../../../Bot'
import Response from '../../../Util/Response'

export class CancelTicketConfirmationFallbackPush extends PushIntent {
  static isContextReplaced = true
  static contextOut = [
    'cCancelTicketConfirmation'
  ]

  public async push(e: EventMiddleware) {
    return this.trigger(e, {
      response: Response.interactiveButton({
        body: [
          'Mohon maaf kami tidak mengerti yang kamu maksud 🙏',
          'Silakan klik tombol di bawah ini.'
        ].join('\n'),
        buttons: [
          {
            reply: {
              id: 'ya',
              title: 'Ya'
            },
            type: 'reply'
          },
          {
            reply: {
              id: 'tidak',
              title: 'Tidak'
            },
            type: 'reply'
          }
        ]
      })
    })
  }
}

export class CancelTicketConfirmationFallback extends FallbackIntent {
  static contextIn = [
    'cCancelTicketConfirmation'
  ]

  public actions() {
    return this.run(LogEvent).run(addChatbotReminder).run(async (e, _, __) => {
      return await new CancelTicketConfirmationFallbackPush().push(e)
    })
  }
}